<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- account.move inherit form view -->
        <record id="inherit_account_move_vr_grouped_products" model="ir.ui.view">
            <field name="name">account.move.inherit.view.form</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_move_form"/>
            <field name="arch" type="xml">

                <!-- ADD PAGE GROUPED PRODUCTS -->
                <xpath expr="//notebook/page[last()]" position="after">
                    <page id="grouped_products" string="Productos Agrupados">
                        <t t-foreach="grouped_products.products_ids" t-as="gr">
                            <span t-esc="gr.name"></span>
                        </t>
                        <field name="grouped_products_ids">
                            <form string="Grupo">
                                <group>
                                    <group>
                                        <div class="oe_title">
                                            <h1>
                                                <field name="code"/>
                                            </h1>
                                        </div>
                                        <field name="total_amount" readonly="1" force_save="1"/>
                                        <field name="description"/>
                                    </group>
                                </group>
                                <div>
                                    <field name="products_ids" no_label="1">
                                        <tree>
                                            <field name="name"/>
                                            <field name="product_uom_qty"/>
                                            <field name="product_uom"/>
                                            <field name="price_unit"/>
                                        </tree>
                                    </field>
                                </div>
                            </form>
                            <tree editable="bottom" create="false" delete="false" edit="false">
                                <field readonly="1" name="code"/>
                                <field readonly="1" name="description"/>
                                <field readonly="1" name="total_amount"/>
                                <button name="view_group" type="object" icon="fa-edit" string="Ver"/>
                            </tree>
                        </field>
                    </page>
                </xpath>

                <xpath expr="//div[@name='journal_div']" position="after">
                    <field name="doctor" attrs="{'invisible':[('move_type','not in',('out_invoice'))]}"/>
                    <field name="patient" attrs="{'invisible':[('move_type','not in',('out_invoice'))]}"/>
                    <field name="hospital" attrs="{'invisible':[('move_type','not in',('out_invoice'))]}"/>
                    <field name="num_sale_order" attrs="{'invisible':[('move_type','not in',('out_invoice'))]}"/>
                </xpath>

                <!-- ADD BUTTON CREATE INVOICE GROUPED PRODDUCTS -->
                <!-- <xpath expr="//header/button[last()]" position="after">
                    <button name="vr_grouped_products_invoice.action_report_vr_grouped_products" 
                            string="Imprimir Factura Agrupada" class="oe_highlight" type="action" 
                            />
                </xpath> -->
            </field>
        </record>
        <!--Modificaciones a lista de facturas-->
        <!--AdiciÃ³n Columna Numero de factura-->
        <record id="vr_view_account_move_inherit_tree" model="ir.ui.view">
            <field name="name">vr.view.account.move.inherit.tree</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_invoice_tree"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='activity_ids']" position="before">
                    <field name="doctor" optional="show"/>
                    <field name="patient" optional="show"/>
                    <field name="hospital" optional="show"/>
                    <field name="razon_social" optional="show"/>
                </xpath>
            </field>
        </record>
    </data>
</odoo>
