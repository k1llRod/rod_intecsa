<odoo>

    <data>

        <record id="action_vr_get_pdf_mp" model="ir.actions.server">
            <field name="name">Impresión (Media Página)</field>
            <field name="model_id" ref="model_account_move"/>
            <field name="binding_model_id" ref="account.model_account_move"/>
            <field name="binding_view_types">form</field>
            <field name="state">code</field>
            <field name="code">
                action = model.vr_get_pdf('media_pagina')
            </field>
        </record>

        <record id="action_vr_get_pdf_rollo" model="ir.actions.server">
            <field name="name">Impresión (Rollo)</field>
            <field name="model_id" ref="model_account_move"/>
            <field name="binding_model_id" ref="account.model_account_move"/>
            <field name="binding_view_types">form</field>
            <field name="state">code</field>
            <field name="code">
                action = model.vr_get_pdf('rollo')
            </field>
        </record>

        <record id="view_account_move_form" model="ir.ui.view">
            <field name="name">view.account.move.form</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_move_form"/>
            <field name="arch" type="xml">

                <xpath expr="//header" position="after">
                    <field name="vr_estado" invisible="1"/>
                    <!-- FACTURA VÁLIDA -->
                    <div class="vr_banner_invoice vr_send_invoice"
                         attrs="{'invisible':[('vr_estado', '!=', 'send'), ('vr_estado', '!=', 'send_and_confirm')]}">Factura válida
                    </div>
                    <!-- FACTURA PENDIENTE -->
                    <div class="vr_banner_invoice vr_pending_invoice"
                         attrs="{'invisible':[('vr_estado', '!=', 'pending')]}">Factura pendiente
                    </div>
                    <!-- FACTURA ANULADA -->
                    <div class="vr_banner_invoice vr_cancelled_invoice"
                         attrs="{'invisible':[('vr_estado', '!=', 'cancelled')]}">Factura anulada
                    </div>
                    <!-- FACTURA ERROR -->
                    <div class="vr_banner_invoice vr_error_invoice"
                         attrs="{'invisible':[('vr_estado', '!=', 'error')]}">Factura con error
                    </div>
                </xpath>

                <xpath expr="//notebook" position="before">
                    <group>
                        <group>
                            <field name="vr_warehouse_id"
                                   domain="[('vr_codigo_sucursal', '!=', False),('vr_tipo_moneda', '!=', False)]"
                                   attrs="{'readonly':[('state', '!=', 'draft')], 'required':[('state', '=', 'draft'),('move_type', '=', 'out_invoice')]}"/>
                            <field name="vr_razon_social"
                                   attrs="{'readonly':[('state', '!=', 'draft')], 'required':[('state', '=', 'draft'),('move_type', '=', 'out_invoice')]}"/>
                        </group>
                        <group>
                            <div style="display:flex; flex-flow:row nowrap;">
                                <label style="font-weight:bold; min-width:146px;" for="vr_nit_ci" string="NIT/CI"/>
                                <field name="vr_nit_ci"
                                       attrs="{'readonly':[('state', '!=', 'draft')], 'required':[('state', '=', 'draft'),('move_type', '=', 'out_invoice')]}"/>
                                <label style="font-weight:bold; width:150px; margin-left:10px;" for="vr_extension"
                                       string="Extensión"/>
                                <field name="vr_extension" style="width:60px;"
                                       attrs="{'readonly':[('state', '!=', 'draft')]}"/>
                            </div>
                        </group>
                        <group>
                            <field name="vr_tipo_documento_identidad"
                                   attrs="{'readonly':[('state', '!=', 'draft')], 'required':[('state', '=', 'draft'),('move_type', '=', 'out_invoice')]}"/>
                        </group>
                        <group>
                            <field string="Método Pago" name="vr_metodo_pago"
                                   attrs="{'readonly':[('state', '!=', 'draft')], 'required':[('state', '=', 'draft'),('move_type', '=', 'out_invoice')]}"/>
                            <!-- CREDIT CARD -->
                            <field name="vr_is_card" invisible="1"/>
                            <field name="vr_nro_tarjeta" invisible="1"/>
                            <label for="vr_nro_tarjeta" attrs="{'invisible':[('vr_is_card','=',False)]}"/>
                            <div style="display:flex; flex-flow:column nowrap; width:100%;"
                                 attrs="{'invisible':[('vr_is_card','=',False)]}">
                                <div style="display:flex; flex-flow:row nowrap; align-items:center; height: 30px;">
                                    <field name="vr_nro_tarjeta_1" widget="credit_card"/>
                                    <field name="vr_nro_tarjeta_2" widget="credit_card"/>
                                    <field name="vr_nro_tarjeta_3" widget="credit_card"/>
                                    <field name="vr_nro_tarjeta_4" widget="credit_card"/>
                                    <span class="vr_span_nro_credit_card" style="color: #00A09D; font-size:30px;">-</span>
                                    <field name="vr_nro_tarjeta_5" widget="credit_card"/>
                                    <field name="vr_nro_tarjeta_6" widget="credit_card"/>
                                    <field name="vr_nro_tarjeta_7" widget="credit_card"/>
                                    <field name="vr_nro_tarjeta_8" widget="credit_card"/>
                                </div>
                            </div>
                        </group>
                    </group>
                </xpath>

                <xpath expr="//page[last()]" position="after">
                    <page string="Datos Facturación Electrónica"
                          attrs="{'invisible':[('vr_numero_factura', '=', 0),('vr_codigo_recepcion', '=', False)]}">
                        <header>
                            <button name="vr_get_mp_pdf" type="object" string="Ver PDF (Media página)" class="oe_link" icon="fa-print"/>
                            <button name="vr_get_rollo_pdf" type="object" string="Ver PDF (Rollo)" class="oe_link" icon="fa-print"/>
                            <button name="vr_get_xml" type="object" string="Descargar XML" class="oe_link" icon="fa-download"/>
                        </header>
                        <group>
                            <group>
                                <field name="vr_numero_factura" readonly="1" force-save="1"/>
                                <field name="vr_link_factura" widget="url" text="Factura SIAT" readonly="1"
                                       force-save="1"/>
                            </group>
                            <group>
                                <field name="vr_codigo_recepcion" readonly="1" force-save="1"/>
                            </group>
                        </group>
                    </page>
                </xpath>

            </field>
        </record>

        <record id="view_account_move_tree" model="ir.ui.view">
            <field name="name">view.account.move.tree</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_out_invoice_tree"/>
            <field name="arch" type="xml">

                <xpath expr="//field[last()]" position="after">
                    <field string="Num. Fact. SIAT" name="vr_numero_factura"/>
                    <field name="vr_estado" widget="badge" decoration-success="vr_estado == 'send'"
                           decoration-warning="vr_estado == 'pending'"
                           decoration-info="vr_estado == 'cancelled'" decoration-danger="vr_estado == 'error'"/>
                </xpath>

            </field>
        </record>

    </data>

</odoo>